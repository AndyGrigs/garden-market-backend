–°—É–ø–µ—Ä –ø–∏—Ç–∞–Ω–Ω—è, –ê–Ω–¥—Ä—ñ—é! üëè –¶–µ –¥—É–∂–µ –≤–∞–∂–ª–∏–≤–∏–π –º–æ–º–µ–Ω—Ç –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ä–æ–∑–¥—ñ–ª–µ–Ω–Ω—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ —Ä–æ–∑—Ä–æ–±–∫–∏ (development) —ñ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ (production), –æ—Å–æ–±–ª–∏–≤–æ —è–∫—â–æ —Ç–∏ —â–µ –Ω–µ –ø—É–±–ª—ñ–∫—É—î—à —Å–≤—ñ–π –±–µ–∫–µ–Ω–¥.

---

## üîπ –©–æ —Ç–∞–∫–µ `process.env.NODE_ENV`?

–¶–µ **—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –∑–º—ñ–Ω–Ω–∞ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞**, —è–∫—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –¥–ª—è —Ç–æ–≥–æ, —â–æ–± –∑—Ä–æ–∑—É–º—ñ—Ç–∏, –≤ —è–∫–æ–º—É —Ä–µ–∂–∏–º—ñ –∑–∞—Ä–∞–∑ –ø—Ä–∞—Ü—é—î —Å–µ—Ä–≤–µ—Ä:
- `"development"` ‚Äî —Ä–æ–∑—Ä–æ–±–∫–∞ (–ª–æ–∫–∞–ª—å–Ω–æ)
- `"production"` ‚Äî –±–æ–π–æ–≤–∏–π —Å–µ—Ä–≤–µ—Ä
- `"test"` ‚Äî —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

> –¶—è –∑–º—ñ–Ω–Ω–∞ **–≤–∂–µ —î** —É Node.js —ñ –Ω–µ –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –¥–æ–¥–∞–≤–∞—Ç–∏ —ó—ó –≤—Ä—É—á–Ω—É –≤ `.env` ‚Äî –≤–æ–Ω–∞ –∑–∞–¥–∞—î—Ç—å—Å—è –∞–±–æ:
> - –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É —Å–∫—Ä–∏–ø—Ç–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `NODE_ENV=production node index.js`)
> - –∞–±–æ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ —Ç–∏–ø—É `npm run build`, `vite`, `webpack` —Ç–æ—â–æ.

---

## üîß –Ø–∫—â–æ —É —Ç–µ–±–µ —â–µ **–ª–æ–∫–∞–ª—å–Ω–∞ —Ä–æ–∑—Ä–æ–±–∫–∞**, —Ç–æ–¥—ñ —Ç–∏ –º–æ–∂–µ—à –ø—Ä–æ—Å—Ç–æ:

### ‚úÖ –í–∞—Ä—ñ–∞–Ω—Ç 1: –Ø–≤–Ω–æ –≤–∫–∞–∑–∞—Ç–∏ `secure: false`
```ts
res.cookie('auth_token', token, {
  httpOnly: true,
  secure: false, // –±–æ —Ç–∏ –ø—Ä–∞—Ü—é—î—à –Ω–∞ localhost –±–µ–∑ HTTPS
  sameSite: 'Strict',
  maxAge: 30 * 24 * 60 * 60 * 1000,
  path: '/'
});
```

> –¶–µ **–æ–∫** –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—ñ. –ê–ª–µ –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–º –Ω–µ –∑–∞–±—É–¥—å –∑–∞–º—ñ–Ω–∏—Ç–∏ –Ω–∞ `secure: true`.

---

## ‚úÖ –í–∞—Ä—ñ–∞–Ω—Ç 2: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ NODE_ENV –¥–∏–Ω–∞–º—ñ—á–Ω–æ (–∫—Ä–∞—â–µ –¥–ª—è –º–∞–π–±—É—Ç–Ω—å–æ–≥–æ)

1. –î–æ–¥–∞–π —É `.env` (—É –∫–æ—Ä—ñ–Ω—å –±–µ–∫–µ–Ω–¥—É):
```
NODE_ENV=development
```

2. –£ –∫–æ–¥—ñ:
```ts
res.cookie('auth_token', token, {
  httpOnly: true,
  secure: process.env.NODE_ENV === 'production',
  sameSite: 'Strict',
  maxAge: 30 * 24 * 60 * 60 * 1000,
  path: '/'
});
```

3. –Ü –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Å—è, —â–æ —Ç–∏ –ø—ñ–¥–∫–ª—é—á–∏–≤ dotenv:
```ts
import dotenv from 'dotenv';
dotenv.config();
```

---

## üîç –î–æ–¥–∞—Ç–∫–æ–≤–æ: —è–∫ –∑–∞–¥–∞—Ç–∏ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –ø—ñ–∑–Ω—ñ—à–µ?

–ö–æ–ª–∏ –±—É–¥–µ—à –≤–∏–∫–ª–∞–¥–∞—Ç–∏ —Å–µ—Ä–≤–µ—Ä, —Ç–∏ –ø—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å–∫–∞—î—à –π–æ–≥–æ —á–µ—Ä–µ–∑:
```bash
NODE_ENV=production node index.js
```
–∞–±–æ –∑–∞–¥–∞—î—à —É `.env` —Ñ–∞–π–ª:
```
NODE_ENV=production
```

---

## ‚ú® –í–∏—Å–Ω–æ–≤–æ–∫:
- –Ø–∫—â–æ —Ç–∏ **–ª–æ–∫–∞–ª—å–Ω–æ —Ä–æ–∑—Ä–æ–±–ª—è—î—à** ‚Äî –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π `secure: false`.
- –Ø–∫—â–æ —Ö–æ—á–µ—à –∑—Ä–æ–±–∏—Ç–∏ –∫–æ–¥ –≥–Ω—É—á–∫–∏–º ‚Äî –¥–æ–¥–∞–π `NODE_ENV` —É `.env` + `dotenv.config()`.

```

## üß™ **–Ø–∫ –ø—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏:**

–ü—ñ—Å–ª—è —Ç–æ–≥–æ —è–∫ –¥–æ–¥–∞—Å–∏ —Ü—ñ –∑–º—ñ–Ω–∏, –º–æ–∂–µ—à –ø—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ **Postman** –∞–±–æ **Thunder Client**:

**1. –°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è:**
```
POST http://localhost:4000/payments/paypal/create-order
Content-Type: application/json

{
  "orderId": "—Ç–≤—ñ–π_order_id",
  "amount": 100,
  "currency": "USD"
}
```

**2. –í—ñ–¥–ø–æ–≤—ñ–¥—å –±—É–¥–µ –º—ñ—Å—Ç–∏—Ç–∏ `approveLink` - –≤—ñ–¥–∫—Ä–∏–π –π–æ–≥–æ –≤ –±—Ä–∞—É–∑–µ—Ä—ñ**

**3. –ü—ñ—Å–ª—è –æ–ø–ª–∞—Ç–∏ –∑–∞—Ö–æ–ø–∏ –ø–ª–∞—Ç—ñ–∂:**
```
POST http://localhost:4000/payments/paypal/capture
Content-Type: application/json

{
  "paypalOrderId": "id_–∑_–ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—ó_–≤—ñ–¥–ø–æ–≤—ñ–¥—ñ"
}
```